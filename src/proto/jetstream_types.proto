package edu.princeton.jetstream;

/**
* Identifies a single node (host).
* Bytes should be an IP4 or IP6 address
*/
message NodeID {
  required bytes address = 1;
  required int32 portno = 2;
}

/**
* A running task (aka operator). The computationID is globally
* unique within a particular JetStream cluster and identifies the computation or topology to which this task belongs. The task field is
* unique within a computation.
*/
message TaskID {
  required int32 computationID = 1;
  required int32 task = 2;
}

message TaskMeta {
  required string cmd = 1;
  required TaskID id = 2;
  optional NodeID site = 3;

  //TODO: Determine minimal set of attributes client must specify for submitted operators.
  // optional int32 partialAggRatio
  // optional boolean isUnion
}

message TableName {
  required string name = 1;
  required int32 id = 2;
}

message TableMeta {
  required TableName name = 1;
  required string schema = 2;
  optional NodeID site = 3;
}



message Element {
    optional int32 i_val = 5;
    optional string s_val = 6;
    optional double d_val = 7 ;
}

message Tuple {
 repeated Element e = 1;
}


/*  These can't be right, I don't think. Tables can have a mix of string, int, etc fields.
These defns give no way to keep track of order.  --Ari

*/
message Table {
 enum Type {INT32 = 1; STRING = 2; DOUBLE = 3;}

  required Type type = 1;

  optional TableMeta meta = 2;
  repeated bytes bytesData = 3;
  repeated string stringData = 4;
  repeated int32 int32Data = 5 [packed=true];
}

message Cube {
  repeated Table tables = 1;
}
